---
// src/components/widgets/MonthCalendar.astro
import Card from "../temple/Card.astro";

const today = new Date();
const year = today.getFullYear();
const month = today.getMonth(); // 0 åŸº
const date = today.getDate();

const monthNames = ["ä¸€æœˆ", "äºŒæœˆ", "ä¸‰æœˆ", "å››æœˆ", "äº”æœˆ", "å…­æœˆ", "ä¸ƒæœˆ", "å…«æœˆ", "ä¹æœˆ", "åæœˆ", "åä¸€æœˆ", "åäºŒæœˆ"];

const weekHeader = ["æ—¥", "ä¸€", "äºŒ", "ä¸‰", "å››", "äº”", "å…­"];

/* ===== å½“æœˆæŽ’ç›˜ ===== */
const firstDay = new Date(year, month, 1).getDay(); // 0-6
const daysInMonth = new Date(year, month + 1, 0).getDate();

const cells: (number | null)[] = [
  ...Array.from({ length: firstDay }, () => null),
  ...Array.from({ length: daysInMonth }, (_, i) => i + 1),
];
---

<Card>
  <div class="month-calendar p-4">
    <!-- å¤´éƒ¨ -->
    <div class="calendar-header mb-3">
      <h3 class="text-lg font-semibold flex items-center gap-2">
        <span class="text-xl">ðŸ“…</span>
        <span>{year} å¹´ {monthNames[month]}</span>
      </h3>
    </div>

    <!-- æ˜ŸæœŸæ ‡é¢˜ -->
    <div class="weekdays grid grid-cols-7 gap-1 mb-2">
      {
        weekHeader.map((d) => (
          <div class="text-center text-xs text-neutral-500 dark:text-neutral-400 font-medium">{d}</div>
        ))
      }
    </div>

    <!-- æ—¥æœŸæ ¼å­ -->
    <div class="calendar-grid grid grid-cols-7 gap-1">
      {
        cells.map((d) => (
          <div
            class:list={[
              "aspect-square flex items-center justify-center rounded text-sm relative",
              d === null
                ? "text-neutral-300 dark:text-neutral-600" // ç©ºç™½
                : d === date
                  ? "ring-2 ring-[var(--c-primary)] font-bold" // ä»Šå¤©
                  : "text-neutral-700 dark:text-neutral-300",
            ]}
          >
            {d ?? ""}
          </div>
        ))
      }
    </div>
  </div>
</Card>

<style lang="scss">
  .month-calendar {
    .calendar-header {
      border-bottom: 1px solid rgba(var(--c-border-rgb), 0.1);
      padding-bottom: 0.75rem;
      h3 {
        color: var(--c-text-1);
      }
    }
    .calendar-grid > div {
      min-height: 32px;
      transition: all 0.2s ease;
    }
  }
</style>
